/* Query 1 */SELECT film_title, category_name, rental_countFROM(SELECT f.title AS film_title, c.name AS category_name, COUNT(r.rental_id) AS rental_countFROM inventory nvJOIN rental rON nv.inventory_id = r.inventory_id JOIN   film fON f.film_id = nv.film_id JOIN  film_category fcON f.film_id = fc.film_id JOIN   category cON c.category_id = fc.category_id  GROUP BY f.title, c.nameHAVING c.name IN ('Animation', 'Children', 'Classics', 'Comedy', 'Family', 'Music')ORDER BY c.name, f.title )t1/* Query 2 */SELECT title, name, rental_duration,standard_quartileFROM (SELECT f.title AS title, c.name AS name, f.rental_duratiON AS rental_duration,NTILE(4) OVER (ORDER BY f.rental_duration) AS standard_quartileFROM film fJOIN   film_category fcON f.film_id = fc.film_idJOIN   category cON c.category_id = fc.category_idWHERE c.name IN ('Animation', 'Children', 'Classics', 'Comedy', 'Family', 'Music')ORDER BY f.rental_duration) t1/* Query 3 */SELECT name, standard_quartile, COUNT(standard_quartile)FROM(SELECT c.name ,  NTILE(4) OVER (ORDER BY f.rental_duration) AS standard_quartileFROM category cJOIN   film_category fcON c.category_id = fc.category_idJOIN   film fON f.film_id = fc.film_idWHERE c.name IN ('Animation', 'Children', 'Classics', 'Comedy', 'Family', 'Music'))sub GROUP BY name, standard_quartile ORDER BY name, standard_quartile/* Query 4 */SELECT  date_part('month', rental_date) AS Rental_month, date_part('year', rental_date) AS Rental_year, s.store_id AS Store_ID, COUNT(r.rental_id) AS Count_rentalsFROM store sJOIN   staff stON s.store_id = st.store_idJOIN   rental rON st.staff_id = r.staff_idGROUP BY Rental_month, Rental_year, s.Store_IDORDER BY Count_rentals desc